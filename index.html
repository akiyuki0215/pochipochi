<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ä¿®ç†å—ä»˜ã‚³ãƒ³ã‚µãƒ«ãƒŠãƒ“ï¼ˆæ–°æ½Ÿã‚¨ãƒªã‚¢ç‰ˆï¼‰</title>
<style>
  :root {
    --bg:#0b5fa5; --card:#fff; --muted:#6b7280;
    --ok:#e8f6ee; --warn:#fff7e5; --ng:#fdecec; --br:14px;
  }
  html,body{margin:0;padding:0;background:#f4f7fb;
    font-family:"Hiragino Kaku Gothic ProN","Noto Sans JP",system-ui,-apple-system,Segoe UI,Roboto,sans-serif;color:#111;}
  header{background:linear-gradient(135deg, var(--bg), #07447a); color:#fff;
    padding:14px 18px; position:sticky; top:0; z-index:10; display:flex; align-items:center; justify-content:space-between;}
  header h1{font-size:18px; margin:0; letter-spacing:.5px;}
  header a.btn{background:#fff; color:#0b5fa5; padding:8px 12px; border-radius:999px; text-decoration:none; font-weight:700; font-size:13px;}
  main{max-width:980px; margin:18px auto; padding:0 12px;}
  .crumb{color:#5c708a; font-size:12px; margin:0 0 8px 6px;}
  .section{background:var(--card); border-radius:var(--br); padding:18px; box-shadow:0 6px 20px rgba(0,0,0,.05); margin-bottom:18px;}
  .row{display:flex; flex-wrap:wrap; gap:10px; margin-top:12px;}
  .chip{border:1px solid #d8e2ee; background:#f7fbff; color:#0b335a; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:600;}
  .chip:active{transform:translateY(1px);}
  .result{padding:16px;border-radius:12px;border:1px solid #dfe7ef;}
  .result.ok{background:var(--ok);} .result.warn{background:var(--warn);} .result.ng{background:var(--ng);}
  .result-title{margin:0 0 8px; font-size:18px; font-weight:700;}
  .actions{display:flex; gap:10px; margin:8px 0 2px;}
  .ghost{background:#eef4fb; border-radius:10px; padding:10px 12px; color:#243b53; font-weight:600; border:1px solid #d8e2ee; cursor:pointer;}
  .ghost:active{transform:translateY(1px);}
  summary{list-style:none; cursor:pointer; padding:12px 14px; background:#f6f9fc; border:1px solid #e4ecf6; border-radius:10px; font-weight:700;}
  summary::-webkit-details-marker{display:none;}
  table{width:100%; border-collapse:collapse; font-size:13px;}
  th,td{padding:10px; border-bottom:1px solid #e8eef7; text-align:left;}
  .muted{color:var(--muted);}
  h1,h2,h3,h4{list-style:none;}
  h1::marker,h2::marker,h3::marker,h4::marker{content:'' !important;}
</style>
</head>
<body>
  <header>
    <h1>ä¿®ç†å—ä»˜ã‚³ãƒ³ã‚µãƒ«ãƒŠãƒ“ï¼ˆæ–°æ½Ÿã‚¨ãƒªã‚¢ç‰ˆï¼‰</h1>
    <a class="btn" href="https://docs.google.com/forms/d/e/1FAIpQLSc5pwJ5ahRwDdJiZNoXA0kSZ7Y9kufFVLL2kqACfH2yQFpsEA/viewform" target="_blank" rel="noopener">æ„è¦‹ã‚’é€ã‚‹ï¼ˆGoogleãƒ•ã‚©ãƒ¼ãƒ ï¼‰</a>
  </header>
  <main>
    <p id="crumb" class="crumb">é€²è¡Œï¼šãƒ¡ãƒ¼ã‚«ãƒ¼é¸æŠ</p>
    <div id="panel" class="section"></div>

    <details id="history" style="display:none;">
      <summary>ğŸ•’ æ›´æ–°å±¥æ­´ï¼ˆã‚¿ãƒƒãƒ—ã§é–‹é–‰ï¼‰</summary>
      <div class="section" style="margin-top:10px;">
        <p class="muted">â€» <code>update_log.json</code> ã‚’èª­ã¿è¾¼ã¿è¡¨ç¤ºã—ã¾ã™ã€‚</p>
        <table id="historyTable">
          <thead><tr><th>æ—¥ä»˜</th><th>åº—èˆ—å</th><th>åå‰</th><th>æ›´æ–°å†…å®¹</th></tr></thead>
          <tbody><tr><td colspan="4" class="muted">èª­ã¿è¾¼ã¿ä¸­â€¦</td></tr></tbody>
        </table>
      </div>
    </details>

    <div class="actions" style="margin-top:10px;">
      <button id="backBtn" class="ghost" disabled>â† ä¸€ã¤å‰ã¸</button>
      <button id="homeBtn" class="ghost">æœ€åˆã‹ã‚‰</button>
    </div>
  </main>

  <script type="module">
    import { ui, app } from './core.js';
    import { renderDomestic, renderSurface } from './vendor_domestic.js';
    import { renderOverseas } from './vendor_overseas.js';
    import { renderVAIO } from './vendor_vaio.js';
    import { renderApple } from './vendor_apple.js';

    async function render(screen="home"){
      if(screen==="home"){
        ui.resetCrumb(); ui.clear();
        const d = app.DATA, p = ui.panel;
        function group(t,l,c){
          const box=document.createElement('div');
          const title=document.createElement('div');
          title.style.fontWeight='700'; title.textContent=t;
          const row=ui.rowBox();
          for(const n of l){ const chip=ui.chip(n,()=>c(n)); row.append(chip); }
          box.append(title,row); p.append(box);
        }
        p.append(ui.h2("ãƒ¡ãƒ¼ã‚«ãƒ¼é¸æŠ"));
        group("å›½å†…ãƒ¡ãƒ¼ã‚«ãƒ¼", d.groups.domestic, n=>{
          if(n==="VAIO"){ui.pushView(render,"vaio");render("vaio");return;}
          if(n==="Surface"){ui.pushView(render,"surface");render("surface");return;}
          ui.pushView(render,"domestic:"+n);render("domestic:"+n);
        });
        group("æµ·å¤–ãƒ¡ãƒ¼ã‚«ãƒ¼", d.groups.overseas, n=>{ui.pushView(render,"overseas:"+n);render("overseas:"+n);});
        group("Surface", d.groups.surface, ()=>{ui.pushView(render,"surface");render("surface");});
        group("Apple", d.groups.apple, ()=>{ui.pushView(render,"apple");render("apple");});
        ui.renderHistoryOnce();
      }
      else if(screen.startsWith("domestic:")){const m=screen.split(":")[1];ui.pushCrumb(m);renderDomestic(m);}
      else if(screen.startsWith("overseas:")){const m=screen.split(":")[1];ui.pushCrumb(m);renderOverseas(m);}
      else if(screen==="vaio"){renderVAIO();}
      else if(screen==="surface"){renderSurface();}
      else if(screen==="apple"){renderApple();}
    }

    async function boot(){
      const r=await fetch('./data.json?v=20251105a',{cache:'no-store'});
      app.DATA=await r.json();
      ui.syncCrumb(); ui.pushView(render,"home"); render("home");
      ui.backBtn.onclick=()=>ui.goBack(render);
      ui.homeBtn.onclick=()=>ui.goHome(render);
    }
    boot();
  </script>
</body>
</html>
