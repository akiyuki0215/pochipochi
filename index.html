
<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ä¿®ç†å—ä»˜ã‚³ãƒ³ã‚µãƒ«ãƒŠãƒ“(æ–°æ½Ÿã‚¨ãƒªã‚¢ç‰ˆ)</title>
<style>
  :root{
    --bg:#f5f7fb;
    --card:#fff;
    --border:#e6e9ef;
    --primary:#0b63ff;
    --primary-weak:#e8f0ff;
    --text:#0f172a;
  }
  html,body{margin:0;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN","Noto Sans JP","Yu Gothic",Meiryo,sans-serif}
  header{background:linear-gradient(135deg,#0b63ff,#0056d6);color:#fff;padding:14px 16px;position:sticky;top:0;z-index:9}
  header .wrap{display:flex;align-items:center;justify-content:space-between;gap:12px}
  h1{font-size:18px;margin:0;font-weight:800}
  .btn{display:inline-flex;align-items:center;gap:.5em;border:1px solid rgba(255,255,255,.25);background:rgba(255,255,255,.15);color:#fff;padding:8px 12px;border-radius:10px;text-decoration:none}
  .btn:hover{background:rgba(255,255,255,.22)}
  main{max-width:960px;margin:18px auto;padding:0 12px}
  .card{background:var(--card);border:1px solid var(--border);border-radius:14px;box-shadow:0 1px 0 rgba(0,0,0,.02);padding:16px}
  .grid{display:grid;gap:12px}
  .grid.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
  .section-title{font-weight:800;margin:0 0 8px 0;font-size:16px}
  .pill{display:inline-flex;align-items:center;gap:.5em;padding:8px 12px;border:1px solid var(--border);border-radius:10px;background:#f7f9fc;cursor:pointer;user-select:none;justify-content:center}
  .pill:hover{background:#eef3ff}
  .group{margin-top:10px}
  .muted{color:#64748b;font-size:13px}
  .path{margin:0 0 10px 0;color:#334155;font-size:13px}
  .kbd{border:1px solid var(--border);background:#f8fafc;border-radius:8px;padding:8px 10px}
  .actions{display:flex;gap:8px;margin-top:12px}
  .link{color:var(--primary);text-decoration:none}
  .link:hover{text-decoration:underline}
  .back-btn,.home-btn{background:#eef2ff;border:1px solid #c7d2fe;color:#3f51b5;border-radius:10px;padding:8px 12px}
  .acc{margin-top:14px}
  .acc summary{list-style:none;cursor:pointer;border:1px solid var(--border);background:#f7f9fc;padding:12px 14px;border-radius:12px;font-weight:700}
  .acc summary::-webkit-details-marker{display:none}
  .acc .content{padding:12px 14px;background:var(--card);border:1px solid var(--border);border-top:none;border-radius:0 0 12px 12px}
  .history-table{width:100%;border-collapse:collapse}
  .history-table th,.history-table td{border-bottom:1px solid var(--border);text-align:left;padding:10px 8px}
  .badge{font-size:12px;padding:2px 8px;border-radius:999px;border:1px solid var(--border);background:#f1f5f9}
  /* çµæœã‚«ãƒ¼ãƒ‰ï¼ˆé…è‰²ï¼‰ */
  .result-card{border-radius:12px;padding:16px;border:1px solid #eee}
  .result-ok{background:#eaf7ec;border-color:#cfe8d4}
  .result-ng{background:#fdeaea;border-color:#f5c2c2}
  .result-warn{background:#fff7e6;border-color:#ffe0a3}
  .result-title{font-weight:800;margin-bottom:8px}
  .result-details{margin:0;padding-left:18px}
  .result-details li{line-height:1.6;margin:4px 0}
</style>
</head>
<body>
<header>
  <div class="wrap">
    <h1>ä¿®ç†å—ä»˜ã‚³ãƒ³ã‚µãƒ«ãƒŠãƒ“(æ–°æ½Ÿã‚¨ãƒªã‚¢ç‰ˆ)</h1>
    <a class="btn" id="feedbackBtn" href="#" target="_blank" rel="noopener">æ„è¦‹ã‚’é€ã‚‹ï¼ˆGoogleãƒ•ã‚©ãƒ¼ãƒ ï¼‰</a>
  </div>
</header>
<main>
  <div class="card">
    <p id="path" class="path">é€²è¡Œï¼šãƒ¡ãƒ¼ã‚«ãƒ¼é¸æŠ</p>
    <div id="view"></div>
    <div class="actions">
      <button class="back-btn" id="backBtn">â† æˆ»ã‚‹</button>
      <button class="home-btn" id="homeBtn">æœ€åˆã‹ã‚‰</button>
    </div>
  </div>

  <details class="acc" id="logAcc">
    <summary>ğŸ•˜ æ›´æ–°å±¥æ­´ï¼ˆã‚¿ãƒƒãƒ—ã§é–‹é–‰ï¼‰</summary>
    <div class="content">
      <table class="history-table" id="logTable">
        <thead><tr><th>æ—¥ä»˜</th><th>åº—èˆ—</th><th>æ‹…å½“</th><th>æ›´æ–°å†…å®¹</th></tr></thead>
        <tbody></tbody>
      </table>
      <p class="muted">â€» å±¥æ­´ã¯ <code>update_log.json</code> ã‚’èª­ã¿è¾¼ã¿è¡¨ç¤ºã—ã¾ã™ã€‚</p>
    </div>
  </details>
</main>

<script>
const GOOGLE_FORM_URL = "https://docs.google.com/forms/d/e/1FAIpQLSc5pwJ5ahRwDdJiZNoXA0kSZ7Y9kufFVLL2kqACfH2yQFpsEA/viewform";
document.getElementById('feedbackBtn').href = GOOGLE_FORM_URL;

const STATE = {
  trail: [], // ãƒ‘ãƒ³ããš
};

function setPath() {
  const p = document.getElementById('path');
  if (!STATE.trail.length) { p.textContent = 'é€²è¡Œï¼šãƒ¡ãƒ¼ã‚«ãƒ¼é¸æŠ'; return; }
  p.textContent = 'é€²è¡Œï¼š' + STATE.trail.map(x=>x.label).join(' > ');
}

function pushTrail(key,label){ STATE.trail.push({key,label}); setPath(); }
function popTrail(){ STATE.trail.pop(); setPath(); }

document.getElementById('homeBtn').onclick = () => renderHome();
document.getElementById('backBtn').onclick = () => { if(STATE.trail.length){ popTrail(); routeFromTrail(); } };

function routeFromTrail(){
  if(STATE.trail.length===0) return renderHome();
  const last = STATE.trail[STATE.trail.length-1].key;
  // æœ«å°¾ã‚­ãƒ¼ã§å†æç”»
  if(last.startsWith('manu:')){
    const manu = last.split(':')[1];
    showManufacturerFlow(manu);
  }else if(last.startsWith('vaio-root')){
    showVaioRoot();
  }else{
    // ãã‚Œä»¥å¤–ã¯ãƒ›ãƒ¼ãƒ ã¸
    renderHome();
  }
}

function renderPills(title, items){
  const view = document.getElementById('view');
  let html = `<h2 class="section-title">${title}</h2><div class="grid cols-2">`;
  html += items.map(it => `<button class="pill" data-key="${it.key}">${it.label}</button>`).join('');
  html += `</div>`;
  view.innerHTML = html;
  view.querySelectorAll('.pill').forEach(b=>b.addEventListener('click', ()=>itClick(b.getAttribute('data-key'))));
}

function itClick(key){
  if(key.startsWith('group:')){
    const g = key.split(':')[1];
    renderGroup(g);
  }else if(key.startsWith('manu:')){
    const manu = key.split(':')[1];
    pushTrail(key, manu);
    showManufacturerFlow(manu);
  }else if(key==='apple'){
    pushTrail('manu:Apple','Apple');
    showAppleFlow();
  }else if(key==='surface'){
    pushTrail('manu:Surface','Surface');
    showSurfaceResult();
  }else if(key==='vaio-root'){
    pushTrail('vaio-root','VAIO');
    showVaioRoot();
  }else if(key.startsWith('vaio-sony')){
    showVaioSony();
  }else if(key.startsWith('vaio-company')){
    showVaioCompanyStep();
  }
}

function renderHome(){
  STATE.trail = [];
  setPath();
  const items = [
    {key:'group:domestic', label:'å›½å†…ãƒ¡ãƒ¼ã‚«ãƒ¼'},
    {key:'group:overseas', label:'æµ·å¤–ãƒ¡ãƒ¼ã‚«ãƒ¼'},
    {key:'surface', label:'Surface'},
    {key:'apple', label:'Apple'}
  ];
  renderPills('ãƒ¡ãƒ¼ã‚«ãƒ¼é¸æŠ', items);
}

function renderGroup(group){
  const list = DATA.groups[group] || [];
  const titleMap = {domestic:'å›½å†…ãƒ¡ãƒ¼ã‚«ãƒ¼', overseas:'æµ·å¤–ãƒ¡ãƒ¼ã‚«ãƒ¼'};
  const items = list.map(name => {
    const key = (name==='VAIO') ? 'vaio-root' : `manu:${name}`;
    return {key, label:name};
  });
  renderPills(titleMap[group]||'ãƒ¡ãƒ¼ã‚«ãƒ¼', items);
}

function yesNo(title, onYes, onNo){
  const view = document.getElementById('view');
  view.innerHTML = `
    <div class="group">
      <div class="section-title">${title}</div>
      <div class="grid cols-2">
        <button class="pill" id="yesBtn">ã¯ã„</button>
        <button class="pill" id="noBtn">ã„ã„ãˆ</button>
      </div>
    </div>`;
  document.getElementById('yesBtn').onclick = onYes;
  document.getElementById('noBtn').onclick = onNo;
}

function renderResult(result){
  const view = document.getElementById('view');
  const cls = (result.status==='ok')?'result-ok':(result.status==='ng')?'result-ng':'result-warn';
  let html = `<div id="result-box" class="result-card ${cls}">`;
  html += `<div class="result-title">${escapeHtml(result.title||'çµæœ')}</div>`;
  if(Array.isArray(result.details) && result.details.length){
    html += `<ul class="result-details">` + result.details.map(x=>`<li>${escapeHtml(x)}</li>`).join('') + `</ul>`;
  }
  html += `</div>`;
  view.innerHTML = html;
}

/* ====== ãƒ•ãƒ­ãƒ¼å®Ÿè£… ====== */

function showManufacturerFlow(name){
  // Surface / Apple / VAIO ã¯å€‹åˆ¥å®Ÿè£…
  if(name==='Surface') return showSurfaceResult();
  if(name==='Apple') return showAppleFlow();
  if(name==='VAIO') return showVaioRoot();

  const isDomestic = DATA.groups.domestic.includes(name);
  const isOverseas = DATA.groups.overseas.includes(name);

  if(isDomestic){
    yesNo('ãƒ¡ãƒ¼ã‚«ãƒ¼ä¿è¨¼ã®æœŸé–“å†…ã§ã™ã‹ï¼Ÿ', () => {
      renderResult({
        status:'warn',
        title:`ãƒ¡ãƒ¼ã‚«ãƒ¼ä¿è¨¼å†…ã®å—ä»˜ï¼ˆ${name}ï¼‰`,
        details: [
          'ãƒ¡ãƒ¼ã‚«ãƒ¼ä¿è¨¼å†…ã¨ã—ã¦å—ä»˜ã—ã¾ã™ã€‚',
          'ãŸã ã—ã€ç—‡çŠ¶ãŒæœªå†ç¾ã‚„ä¿®ç†ä¸­æ­¢æ™‚ã«ã¯è¦‹ç©ã‚‚ã‚Šæ‰‹æ•°æ–™ãŒç™ºç”Ÿã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚',
          'ãƒ¡ãƒ¼ã‚«ãƒ¼ä¿è¨¼æ›¸ç­‰ã‚’æ·»ä»˜ã®ä¸Šã€ä¿®ç†å—ä»˜ã‚’ã—ã¦ãã ã•ã„ã€‚'
        ]
      });
    }, () => {
      yesNo(DATA.text.common.q_hasNojima, () => {
        renderResult({
          status:'ok',
          title:`åº—èˆ—ã§ã®ä¿®ç†å—ä»˜ï¼šå¯èƒ½ï¼ˆãƒã‚¸ãƒä¿è¨¼ãƒ»${name}ï¼‰`,
          details:[
            'åº—èˆ—ã§ã®ä¿®ç†å—ä»˜ã¯å¯èƒ½ã§ã™ã€‚ä¿è¨¼å¯¾è±¡å¤–ã¨ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹æ—¨ã‚’ãŠä¼ãˆã—ã¤ã¤å—ä»˜ã‚’é€²ã‚ã¦ãã ã•ã„ã€‚',
            'å‰å—ã‘é‡‘ã¯å¿…è¦ã‚ã‚Šã¾ã›ã‚“ã€‚'
          ]
        });
      }, () => {
        renderResult({
          status:'warn',
          title:'ä¿®ç†å—ä»˜ã¯å¯èƒ½ï¼ˆå‰å—ã‘é‡‘ã‚ã‚Šï¼‰',
          details:[
            'å‰å—ã‘é‡‘5,500å††ï¼ˆç¾é‡‘ã®ã¿ï¼‰ã‚’ã„ãŸã ã„ã¦ä¿®ç†å—ä»˜å¯èƒ½ã§ã™ã€‚',
            'ä¿®ç†ã‚­ãƒ£ãƒ³ã‚»ãƒ«æ™‚ã€ãƒ¡ãƒ¼ã‚«ãƒ¼å´ã§å‰å—é‡‘ã‚’è¶…ãˆã‚‹è¦‹ç©ã‚‚ã‚Šè²»ãŒç™ºç”Ÿã—ã¦ã‚‚ã€ä»•å…¥ã‚Œå—ã‘å…¥ã‚Œæ™‚ã«é‡‘é¡5,500å††ã¸ä¿®æ­£OKã€‚',
            'BYODâ†’æ¥­å‹™ãƒ¡ãƒ‹ãƒ¥ãƒ¼â†’ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã€æ–‡ç« ç®¡ç†ã€‘â†’ç¬¬07ç«  ä¿®ç†æ¥­å‹™â†’ã€Œä¿®ç†å—ä»˜ã®ã‚ˆãã‚ã‚‹è³ªå•ã€â†’ã€Œå‰å—é‡‘ã«é–¢ã™ã‚‹ã“ã¨ ã€å‚ç…§'
          ]
        });
      });
    });
  }else if(isOverseas){
    yesNo('ãƒ¡ãƒ¼ã‚«ãƒ¼ä¿è¨¼ã®æœŸé–“å†…ã§ã™ã‹ï¼Ÿ', () => {
      yesNo(DATA.text.common.q_hasNojima, () => {
        renderResult({
          status:'ok',
          title:'åº—èˆ—ã§ã®ä¿®ç†å—ä»˜ï¼šå¯¾å¿œå¯èƒ½',
          details:[
            'ãƒã‚¸ãƒä¿è¨¼åŠ å…¥ã®ãŸã‚ã€åº—èˆ—ã§ä¿®ç†å—ä»˜ãŒå¯èƒ½ã§ã™ã€‚è¦ç´„ã¨å¿…è¦æ›¸é¡ã‚’ç¢ºèªã®ã†ãˆæ‰‹ç¶šãã‚’é€²ã‚ã¦ãã ã•ã„ã€‚',
            'ç—‡çŠ¶æœªå†ç¾ã‚„ãŠå®¢æ§˜éƒ½åˆã®ä¿®ç†ä¸­æ­¢æ™‚ã¯è¦‹ç©ã‚Šä»£ãŒã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚'
          ]
        });
      }, () => {
        renderResult({
          status:'warn',
          title:'ä¿®ç†å—ä»˜å¯èƒ½ï¼ˆæ³¨æ„å–šèµ·ï¼‰',
          details:[
            'ãƒã‚¸ãƒã§ã®ä¿®ç†å—ä»˜ã¯å¯èƒ½ã§ã™ã€‚',
            'ãŸã ã—ã€ãƒ¡ãƒ¼ã‚«ãƒ¼ã¸ç›´æ¥ä¾é ¼ã™ã‚‹ã‚ˆã‚Šä¿®ç†é‡‘é¡ãŒé«˜é¡ã«ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚',
            'ã”èª¬æ˜ã®ã†ãˆã€ãŠå®¢æ§˜ã®ã”åˆ¤æ–­ã‚’å°Šé‡ã—ã¦ãã ã•ã„ã€‚'
          ]
        });
      });
    }, () => {
      renderResult({
        status:'warn',
        title:'ä¿®ç†å—ä»˜å¯èƒ½ï¼ˆæ³¨æ„å–šèµ·ï¼‰',
        details:[
          'ãƒã‚¸ãƒã§ã®ä¿®ç†å—ä»˜ãŒå¯èƒ½ã§ã™ã€‚',
          'ãŸã ã—ä¸‡ãŒä¸€æœ‰å„Ÿä¿®ç†ã®å ´åˆã€ãŠå®¢æ§˜ã¨ãƒ¡ãƒ¼ã‚«ãƒ¼ã®ç›´æ¥ã‚„ã‚Šå–ã‚Šã‚ˆã‚Šé«˜é¡ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚',
          'ã”èª¬æ˜ã®ä¸Šã€åˆ¤æ–­ã‚’å°Šé‡ã—ã¦ãã ã•ã„ã€‚'
        ]
      });
    });
  }else{
    renderResult({status:'warn', title:`${name} ã®åˆ†å²å®šç¾©ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`, details:['data.json ã® groups ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚']});
  }
}

function showSurfaceResult(){
  renderResult({
    status:'ng',
    title:'åº—èˆ—ä¿®ç†å—ä»˜ä¸å¯ï¼ˆSurfaceï¼‰',
    details:[
      'å½“åº—ã§ã®ä¿®ç†å—ä»˜ã¯ã§ãã¾ã›ã‚“ã€‚ãŠå®¢æ§˜ã¨ãƒ¡ãƒ¼ã‚«ãƒ¼ã§ç›´æ¥ã®ã‚„ã‚Šå–ã‚Šã«ãªã‚Šã¾ã™ã€‚',
      'ãƒã‚¤ã‚¯ãƒ­ã‚½ãƒ•ãƒˆã‚µãƒãƒ¼ãƒˆã‚»ãƒ³ã‚¿ãƒ¼ï¼ˆSurfaceå°‚ç”¨ï¼‰',
      'é›»è©±ç•ªå·ï¼š0120-54-2244',
      'å—ä»˜æ™‚é–“ï¼šæœˆã€œé‡‘ 9:00ã€œ18:00ï¼ˆåœŸæ—¥ç¥ä¼‘ã¿ï¼‰'
    ]
  });
}

function showAppleFlow(){
  yesNo('ãƒ¡ãƒ¼ã‚«ãƒ¼ä¿è¨¼ã®æœŸé–“å†…ã§ã™ã‹ï¼Ÿ', () => {
    // ãƒ¡ãƒ¼ã‚«ãƒ¼ä¿è¨¼å†… â†’ åº—é ­å—ä»˜ä¸å¯ + Apple ç›´æ¡ˆå†… + ãã®å¾Œãƒã‚¸ãƒä¿è¨¼åˆ†å²
    renderResult({
      status:'ng',
      title:'åº—é ­å—ä»˜ä¸å¯ï¼ˆAppleã¸ç›´æ¥æ¡ˆå†…ï¼‰',
      details:[
        'ãƒã‚¸ãƒåº—é ­ã§ã®ä¿®ç†å—ä»˜ã¯ã§ãã¾ã›ã‚“ã€‚Appleã¨ãŠå®¢æ§˜ã§ç›´æ¥ã®ä¿®ç†å¯¾å¿œã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚',
        'Appleã‚µãƒ¼ãƒ“ã‚¹&ã‚µãƒãƒ¼ãƒˆãƒ©ã‚¤ãƒ³ã€€0120-277-535 ã¸ã®ã”é€£çµ¡ã‚’ãŠå®¢æ§˜ã«ãŠä¼ãˆãã ã•ã„ã€‚'
      ]
    });
    // ç¶šã‘ã¦ãƒã‚¸ãƒä¿è¨¼ã‚¿ã‚¤ãƒ—é¸æŠ
    setTimeout(()=>{
      const view = document.getElementById('view');
      const extra = document.createElement('div');
      extra.className = 'group';
      extra.innerHTML = `
        <div class="section-title">ãƒã‚¸ãƒä¿è¨¼ã®ã”åŠ å…¥çŠ¶æ³ã‚’é¸æŠã—ã¦ãã ã•ã„</div>
        <div class="grid cols-2">
          <button class="pill" id="ult">â‘  ã‚¢ãƒ«ãƒ†ã‚£ãƒ¡ãƒƒãƒˆä¿è¨¼</button>
          <button class="pill" id="pp">â‘¡ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¿è¨¼ãƒ—ãƒ©ã‚¹</button>
          <button class="pill" id="none">â‘¢ ä¿è¨¼ã«å…¥ã£ã¦ã„ãªã„</button>
        </div>`;
      view.appendChild(extra);
      document.getElementById('ult').onclick = ()=> renderResult({
        status:'ok',
        title:'åº—èˆ—ã§ã®å•†å“äº¤æ›ãƒ»ãƒã‚¤ãƒ³ãƒˆãƒãƒƒã‚¯å¯¾å¿œï¼ˆã‚¢ãƒ«ãƒ†ã‚£ãƒ¡ãƒƒãƒˆä¿è¨¼ï¼‰',
        details:[
          'åº—èˆ—ã§ã®å•†å“äº¤æ›ã¾ãŸã¯ãƒã‚¤ãƒ³ãƒˆãƒãƒƒã‚¯å¯¾å¿œãŒå¯èƒ½ã§ã™ã€‚',
          'ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã‚’ç¢ºèªã—ãªãŒã‚‰å¯¾å¿œã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚'
        ]
      });
      document.getElementById('pp').onclick = ()=> {
        yesNo('2023å¹´6æœˆ1æ—¥ä»¥é™ã«è³¼å…¥ã•ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ', ()=>{
          renderResult({
            status:'ok',
            title:'ä¿®ç†å—ä»˜ï¼ˆPremium+ãƒ»2023/6/1 ä»¥é™ï¼‰',
            details:[
              'Appleç”¨ã®è£½å“ä¿®ç†ç”³è¾¼æ›¸ã‚’è¨˜è¼‰ã®ä¸Šã€ä¿®ç†å—ä»˜ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚',
              'ãƒã‚¤ãƒ³ãƒˆãƒãƒƒã‚¯ã§ã®å¯¾å¿œã«ãªã‚Šã¾ã™ã€‚',
              'è‡ªç„¶æ•…éšœã€ç‰©æã®å ´åˆã§ãƒ•ãƒ­ãƒ¼ãŒå¤‰ã‚ã‚‹ã®ã§ã€è©³ã—ãã¯MDç­‰ã¸ã®ç¢ºèªã‚’è¡Œã£ã¦ãã ã•ã„ã€‚',
              'â€» Appleè£½å“ä¿®ç†ç”³è¾¼æ›¸ã¯ãƒ‡ã‚¹ã‚¯ãƒãƒƒãƒ„ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡ºæ¥ã¾ã™'
            ]
          });
        }, ()=>{
          renderResult({
            status:'ok',
            title:'åº—é ­ä¿®ç†å—ä»˜ï¼ˆPremium+ãƒ»2023/5/31 ä»¥å‰ï¼‰',
            details:[
              'é€šå¸¸é€šã‚Šä¿®ç†å—ä»˜ã‚’ã—ã¦ãã ã•ã„ã€‚',
              'ææºä¿®ç†å…ˆã‚¦ãƒãƒ€ã‚¨ã‚¹ã‚³ã§ã®ä¿®ç†å¯¾å¿œã«ãªã‚Šã¾ã™ã€‚',
              'Appleç”¨è£½å“ä¿®ç†ç”³è¾¼æ›¸ã‚’è¨˜è¼‰ã®ä¸Šã€ä¿®ç†å—ä»˜ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚',
              'â€» Appleè£½å“ä¿®ç†ç”³è¾¼æ›¸ã¯ãƒ‡ã‚¹ã‚¯ãƒãƒƒãƒ„ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡ºæ¥ã¾ã™'
            ]
          });
        });
      };
      document.getElementById('none').onclick = ()=> renderResult({
        status:'ng',
        title:'Appleã§ã®ç›´æ¥ä¿®ç†ã‚’ã”æ¡ˆå†…ï¼ˆæœªåŠ å…¥ï¼‰',
        details:[
          'ãƒã‚¸ãƒä¿è¨¼ã«æœªåŠ å…¥ã®ãŸã‚ã€Appleã§ã®ç›´æ¥ä¿®ç†ã‚’ã”æ¡ˆå†…ãã ã•ã„ã€‚',
          'Appleã‚µãƒ¼ãƒ“ã‚¹&ã‚µãƒãƒ¼ãƒˆãƒ©ã‚¤ãƒ³ã€€0120-277-535 ã¸ã®ã”é€£çµ¡ã‚’ãŠå®¢æ§˜ã«ãŠä¼ãˆãã ã•ã„ã€‚'
        ]
      });
    },0);
  }, ()=>{
    // ä¿è¨¼å¤– â†’ ãƒã‚¸ãƒä¿è¨¼ã‚¿ã‚¤ãƒ—ã¸ï¼ˆç°¡ç•¥ï¼‰
    yesNo(DATA.text.common.q_hasNojima, ()=>{
      renderResult({status:'ok', title:'åº—é ­ä¿®ç†å—ä»˜ï¼ˆAppleãƒ»ãƒã‚¸ãƒä¿è¨¼åŠ å…¥ï¼‰', details:[
        'åº—èˆ—ã§ä¿®ç†å—ä»˜ãŒå¯èƒ½ã§ã™ã€‚å¿…è¦æ›¸é¡ã‚’ç¢ºèªã—ãªãŒã‚‰æ‰‹ç¶šãã‚’é€²ã‚ã¦ãã ã•ã„ã€‚',
        'â€» Appleè£½å“ä¿®ç†ç”³è¾¼æ›¸ã¯ãƒ‡ã‚¹ã‚¯ãƒãƒƒãƒ„ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡ºæ¥ã¾ã™'
      ]});
    }, ()=>{
      renderResult({status:'ng', title:'Appleã§ã®ç›´æ¥ä¿®ç†ã‚’ã”æ¡ˆå†…ï¼ˆæœªåŠ å…¥ï¼‰', details:[
        'ãƒã‚¸ãƒä¿è¨¼ã«æœªåŠ å…¥ã®ãŸã‚ã€Appleã§ã®ç›´æ¥ä¿®ç†ã‚’ã”æ¡ˆå†…ãã ã•ã„ã€‚',
        'Appleã‚µãƒ¼ãƒ“ã‚¹&ã‚µãƒãƒ¼ãƒˆãƒ©ã‚¤ãƒ³ã€€0120-277-535 ã¸ã®ã”é€£çµ¡ã‚’ãŠå®¢æ§˜ã«ãŠä¼ãˆãã ã•ã„ã€‚'
      ]});
    });
  });
}

/* === VAIO åˆ†å² === */
function showVaioRoot(){
  const view = document.getElementById('view');
  const info = `
    <div class="muted" style="margin-bottom:8px">
      <strong>æ™‚æœŸç›®å®‰ãƒ»è£½é€ å…ƒ</strong><br>
      ã€œ2014å¹´6æœˆé ƒã¾ã§ â†’ ã‚½ãƒ‹ãƒ¼æ ªå¼ä¼šç¤¾<br>
      2014å¹´7æœˆä»¥é™ â†’ VAIOæ ªå¼ä¼šç¤¾ï¼ˆé•·é‡çœŒå®‰æ›‡é‡å¸‚ï¼‰
    </div>`;
  view.innerHTML = info;
  renderPills('ã©ã¡ã‚‰ã®VAIOã§ã™ã‹ï¼Ÿ',[
    {key:'vaio-sony',label:'Sonyæ ªå¼ä¼šç¤¾ãŒè²©å£²ã—ãŸVAIO'},
    {key:'vaio-company',label:'VAIOæ ªå¼ä¼šç¤¾ãŒè²©å£²ã—ãŸVAIO'}
  ]);
}

function showVaioSony(){
  renderResult({
    status:'ng',
    title:'å—ä»˜çµ‚äº†ï¼ˆSonyè£½VAIOï¼‰',
    details:[
      'Sonyæ ªå¼ä¼šç¤¾ãŒè²©å£²ã—ã¦ã„ã‚‹VAIOè£½å“ã®ä¿®ç†å—ä»˜ã¯çµ‚äº†ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒé«˜ã„ã§ã™ãŒã€ä¸‹è¨˜ã«ã¦å•ã„åˆã‚ã›å¯èƒ½ã§ã™ã€‚',
      'VAIOã‚«ã‚¹ã‚¿ãƒãƒ¼ãƒªãƒ³ã‚¯ä¿®ç†ç›¸è«‡çª“å£ï¼š0120-60-5599ï¼ˆãƒ•ãƒªãƒ¼ãƒ€ã‚¤ãƒ¤ãƒ«ï¼‰',
      'å—ä»˜æ™‚é–“ï¼šæœˆï½é‡‘ 9:00ï½18:00ï¼ˆç¥æ—¥ãƒ»å¹´æœ«å¹´å§‹é™¤ãï¼‰'
    ]
  });
}

function showVaioCompanyStep(){
  yesNo('å½“ç¤¾ï¼ˆãƒã‚¸ãƒï¼‰ã§è³¼å…¥ã•ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ', ()=>{
    renderResult({
      status:'ok',
      title:'åº—èˆ—ã§ã®ä¿®ç†å—ä»˜ï¼šå¯èƒ½ï¼ˆVAIOæ ªå¼ä¼šç¤¾ãƒ»å½“ç¤¾è³¼å…¥ï¼‰',
      details:[
        'ä¿®ç†å—ä»˜ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚',
        'ä¿®ç†ä¾é ¼å…ˆ:ãƒã‚¸ãƒä¿®ç†ã‚»ãƒ³ã‚¿ãƒ¼(ä¿®ç†ã‚»ãƒ³ã‚¿ãƒ¼çµŒç”±ã§VAIOã«ä¿®ç†ä¾é ¼)',
        'ä¿å®ˆæœŸé–“:ç™ºå£²æ—¥ã‹ã‚‰ç´„5å¹´(ç›®å®‰)'
      ]
    });
  }, ()=>{
    renderResult({
      status:'warn',
      title:'åº—èˆ—ã§ã®ä¿®ç†å—ä»˜ï¼šå¯èƒ½ï¼ˆæ³¨æ„å–šèµ·ã‚ã‚Šï¼‰',
      details:[
        'ä¿®ç†å—ä»˜ã¯å¯èƒ½ã§ã™ãŒã€ãŠå®¢æ§˜ãŒãƒ¡ãƒ¼ã‚«ãƒ¼ã¨ç›´æ¥ã‚„ã‚Šå–ã‚Šã‚’ã™ã‚‹ã‚ˆã‚Šã‚‚é«˜é¡ã«ãªã‚‹å¯èƒ½æ€§ãŒé«˜ã„ã§ã™ã€‚',
        'ã”äº†æ‰¿ã‚’ã„ãŸã ã„ãŸä¸Šã§å—ä»˜ã‚’é€²ã‚ã¦ãã ã•ã„ã€‚'
      ]
    });
  });
}

/* ====== utils ====== */
function escapeHtml(s){return String(s).replace(/[&<>\"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]))}

/* ====== ãƒ‡ãƒ¼ã‚¿èª­è¾¼ ====== */
async function loadJSON(path, fallback){
  try{
    const res = await fetch(path, {cache:'no-store'});
    if(!res.ok) throw 0;
    return await res.json();
  }catch(e){
    return fallback;
  }
}

let DATA = null;

async function boot(){
  DATA = await loadJSON('data.json', {
    groups:{
      domestic:["NEC","Fujitsu","Dynabook","VAIO","Mouse Computer"],
      overseas:["ASUS","Dell","Lenovo","MSI"]
    },
    text:{common:{q_hasNojima:"ãƒã‚¸ãƒã®ä¿è¨¼ã«å…¥ã£ã¦ã„ã¾ã™ã‹ï¼Ÿ"}}
  });

  // å±¥æ­´ã®èª­ã¿è¾¼ã¿ï¼ˆãƒˆãƒƒãƒ—ã ã‘ï¼‰
  const log = await loadJSON('update_log.json',{logs:[]});
  const tbody = document.querySelector('#logTable tbody');
  tbody.innerHTML = log.logs.map(row => (
    `<tr><td>${escapeHtml(row.date||'')}</td><td>${escapeHtml(row.store||'')}</td><td>${escapeHtml(row.person||'')}</td><td>${escapeHtml(row.note||'')}</td></tr>`
  )).join('');

  renderHome();
}

boot();
</script>
</body>
</html>
