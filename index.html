
<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ä¿®ç†å—ä»˜ã‚³ãƒ³ã‚µãƒ«ãƒŠãƒ“(æ–°æ½Ÿã‚¨ãƒªã‚¢ç‰ˆ)</title>
  <style>
    :root{
      --ok:#e9f7ef;
      --ng:#fdecea;
      --warn:#fff7e6;
      --card:#ffffff;
      --ink:#1f2937;
      --muted:#6b7280;
      --brand:#1e3a8a;
      --btn:#eef2ff;
      --btn-ink:#1e3a8a;
      --radius:14px;
    }
    html,body{margin:0;background:#f6f7fb;color:var(--ink);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans JP","Hiragino Kaku Gothic ProN","Yu Gothic UI","YuGothic","Meiryo",sans-serif;}
    header{
      background:linear-gradient(120deg,#0b5bd7,#1e3a8a);
      color:#fff;padding:14px 18px;display:flex;align-items:center;justify-content:space-between;gap:12px;
    }
    header h1{font-size:18px;margin:0;font-weight:700;}
    header .link-btn a{background:#1642a5;color:#fff;text-decoration:none;padding:10px 14px;border-radius:999px;display:inline-block}
    main{max-width:980px;margin:18px auto;padding:0 14px}
    .card{background:var(--card);border-radius:var(--radius);box-shadow:0 6px 18px rgba(16,24,40,.06);padding:18px;margin:0 0 16px}
    .row{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:12px}
    .pill{border:1px solid #e5e7eb;background:var(--btn);color:var(--btn-ink);border-radius:999px;padding:12px 14px;text-align:center;cursor:pointer;font-weight:600}
    .pill:hover{filter:brightness(0.98)}
    .nav{display:flex;gap:8px;margin-top:10px}
    .nav button{border:1px solid #e5e7eb;background:#fff;border-radius:10px;padding:8px 12px;cursor:pointer}
    .breadcrumb{font-size:12px;color:var(--muted);margin:2px 0 10px}
    .result{border-left:6px solid #d1fae5;background:var(--ok)}
    .result.ng{border-left-color:#fecaca;background:var(--ng)}
    .result.warn{border-left-color:#fde68a;background:var(--warn)}
    .result h3{margin:4px 0 10px;font-size:18px}
    /* è¦‹å‡ºã—ã®ãƒ‰ãƒƒãƒˆ(ãƒªã‚¹ãƒˆ)ã¯å®Œå…¨ã«ä½¿ã‚ãªã„ */
    ul{list-style:none;padding-left:0;margin:0}
    li{margin:0}
    .result p{margin:8px 0 0}
    details{background:#fff;border-radius:12px;padding:8px 12px}
    summary{cursor:pointer;color:#1f2937;font-weight:700}
    .muted{color:var(--muted)}
  </style>
</head>
<body>
  <header>
    <h1>ä¿®ç†å—ä»˜ã‚³ãƒ³ã‚µãƒ«ãƒŠãƒ“(æ–°æ½Ÿã‚¨ãƒªã‚¢ç‰ˆ)</h1>
    <div class="link-btn"><a id="feedback" href="#" target="_blank" rel="noopener">æ„è¦‹ã‚’é€ã‚‹ï¼ˆGoogleãƒ•ã‚©ãƒ¼ãƒ ï¼‰</a></div>
  </header>
  <main>
    <section class="card">
      <div class="breadcrumb" id="crumbs">é€²è¡Œï¼šãƒ¡ãƒ¼ã‚«ãƒ¼é¸æŠ</div>
      <div id="stage"></div>
      <div class="nav"><button id="backBtn">â† æˆ»ã‚‹</button><button id="homeBtn">æœ€åˆã‹ã‚‰</button></div>
    </section>

    <section class="card">
      <details>
        <summary>ğŸ•’ æ›´æ–°å±¥æ­´ï¼ˆã‚¿ãƒƒãƒ—ã§é–‹é–‰ï¼‰</summary>
        <div id="changelog" class="muted" style="margin-top:10px"></div>
      </details>
    </section>
  </main>

  <script>
  const GOOGLE_FORM_URL = "https://docs.google.com/forms/d/e/1FAIpQLSc5pwJ5ahRwDdJiZNoXA0kSZ7Y9kufFVLL2kqACfH2yQFpsEA/viewform";
  document.getElementById('feedback').href = GOOGLE_FORM_URL;

  const state = { stack: [] };
  const crumbs = document.getElementById('crumbs');
  const stage = document.getElementById('stage');
  const backBtn = document.getElementById('backBtn');
  const homeBtn = document.getElementById('homeBtn');

  backBtn.onclick = ()=> { if(state.stack.length>1){ state.stack.pop(); render(state.stack.at(-1)); } };
  homeBtn.onclick = ()=> { state.stack = []; render({type:'home'}); };

  // ---------- data loader ----------
  let DATA = null;
  async function load(){
    try{
      const resp = await fetch('data.json', {cache:'no-store'});
      DATA = await resp.json();
    }catch(e){
      stage.innerHTML = "<p class='muted'>ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</p>";
      console.error(e);
    }
  }

  function renderHome(){
    crumbs.textContent = "é€²è¡Œï¼šãƒ¡ãƒ¼ã‚«ãƒ¼é¸æŠ";
    const makers = [
      ...(DATA.groups?.domestic || []),
      ...(DATA.groups?.overseas || []),
      ...(DATA.groups?.surface || []),
      ...(DATA.groups?.apple || []),
    ];
    const html = [`<div class="row">`,
      ...makers.map(m=>`<div class="pill" data-maker="${m}">${m}</div>`),
      `</div>`].join("");
    stage.innerHTML = html;
    stage.querySelectorAll('.pill').forEach(btn=>{
      btn.addEventListener('click',()=>{
        const maker = btn.dataset.maker;
        goNext({type:'maker', maker});
      });
    });
  }

  function setResult(title, details=[], tone='ok'){
    const cls = tone==='ng'?'result ng':(tone==='warn'?'result warn':'result');
    const body = [ `<div class="${cls} card">`,
      `<h3>${title}</h3>`,
      ...details.map(t=>`<p>${t}</p>`),
      `</div>`].join("");
    stage.innerHTML = body;
  }

  function goNext(node){
    state.stack.push(node);
    render(node);
  }

  function render(node){
    if(!node || node.type==='home') return renderHome();

    if(node.type==='maker'){
      crumbs.textContent = `é€²è¡Œï¼š${node.maker}`;
      // Special routes
      if(node.maker==='Surface'){
        const s = DATA.text.surface;
        return setResult(s.r_title, [
          ...s.r_details,
          "ãƒã‚¤ã‚¯ãƒ­ã‚½ãƒ•ãƒˆã‚µãƒãƒ¼ãƒˆã‚»ãƒ³ã‚¿ãƒ¼ï¼ˆSurfaceå°‚ç”¨ï¼‰",
          "é›»è©±ç•ªå·ï¼š0120-54-2244",
          "å—ä»˜æ™‚é–“ï¼šæœˆã€œé‡‘ 9:00ã€œ18:00ï¼ˆåœŸæ—¥ç¥ä¼‘ã¿ï¼‰"
        ], 'ng');
      }
      if(node.maker==='Apple'){
        crumbs.textContent = `é€²è¡Œï¼šApple`;
        renderAppleStart();
        return;
      }
      if(node.maker==='VAIO'){
        return renderVAIOGate();
      }
      // Common domestic / overseas flow
      const isDomestic = DATA.groups.domestic.includes(node.maker) || node.maker==='VAIO' || node.maker==='Mouse Computer';
      const isOverseas = DATA.groups.overseas.includes(node.maker);
      const dom = DATA.text.domestic;
      const over = DATA.text.overseas;
      stage.innerHTML = `
        <div class="row">
          <div class="pill" data-ans="yes">ãƒ¡ãƒ¼ã‚«ãƒ¼ä¿è¨¼ã®æœŸé–“å†…ã§ã™ã‹ï¼Ÿï¼ˆã¯ã„ï¼‰</div>
          <div class="pill" data-ans="no">ãƒ¡ãƒ¼ã‚«ãƒ¼ä¿è¨¼ã®æœŸé–“å†…ã§ã™ã‹ï¼Ÿï¼ˆã„ã„ãˆï¼‰</div>
        </div>
      `;
      stage.querySelectorAll('.pill').forEach(b=>b.onclick = ()=>{
        const ans = b.dataset.ans;
        if(isDomestic){
          if(ans==='yes'){
            setResult(dom.r_warranty_title, [
              ...dom.r_warranty_details,
              "ãƒ¡ãƒ¼ã‚«ãƒ¼ä¿è¨¼æ›¸ç­‰ã‚’æ·»ä»˜ã®ä¸Šã€ä¿®ç†å—ä»˜ã‚’ã—ã¦ãã ã•ã„ã€‚"
            ], 'ok');
          }else{
            // ä¿è¨¼å¤– â†’ ãƒã‚¸ãƒä¿è¨¼ã‚ã‚‹ï¼Ÿ
            stage.innerHTML = `
              <div class="row">
                <div class="pill" data-nj="yes">${DATA.text.common.q_hasNojima}ï¼ˆã¯ã„ï¼‰</div>
                <div class="pill" data-nj="no">${DATA.text.common.q_hasNojima}ï¼ˆã„ã„ãˆï¼‰</div>
              </div>
            `;
            stage.querySelectorAll('.pill').forEach(p=>p.onclick=()=>{
              const nj = p.dataset.nj;
              if(nj==='yes'){
                setResult(dom.r_nojima_ok_title, dom.r_nojima_ok_details, 'ok');
              }else{
                const t = dom.r_prepay_details.concat([
                  "ä¿®ç†ã‚­ãƒ£ãƒ³ã‚»ãƒ«æ™‚ã€ãƒ¡ãƒ¼ã‚«ãƒ¼å´ã§å‰å—é‡‘ã‚’è¶…ãˆã‚‹è¦‹ç©ã‚‚ã‚Šè²»ãŒç™ºç”Ÿã—ã¦ã‚‚ã€ä»•å…¥ã‚Œå—ã‘å…¥ã‚Œæ™‚ã«é‡‘é¡5,500å††ã¸ä¿®æ­£OKã€‚",
                  "BYODâ†’æ¥­å‹™ãƒ¡ãƒ‹ãƒ¥ãƒ¼â†’ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã€æ–‡ç« ç®¡ç†ã€‘â†’ç¬¬07ç«  ä¿®ç†æ¥­å‹™â†’ã€Œä¿®ç†å—ä»˜ã®ã‚ˆãã‚ã‚‹è³ªå•ã€â†’ã€Œå‰å—é‡‘ã«é–¢ã™ã‚‹ã“ã¨ ã€å‚ç…§"
                ]);
                setResult(dom.r_prepay_title, t, 'warn');
              }
            });
          }
        }else if(isOverseas){
          if(ans==='yes'){
            // æµ·å¤–ï¼šä¿è¨¼å†… â†’ ãƒã‚¸ãƒä¿è¨¼ï¼Ÿ
            stage.innerHTML = `
              <div class="row">
                <div class="pill" data-nj="yes">${DATA.text.common.q_hasNojima}ï¼ˆã¯ã„ï¼‰</div>
                <div class="pill" data-nj="no">${DATA.text.common.q_hasNojima}ï¼ˆã„ã„ãˆï¼‰</div>
              </div>
            `;
            stage.querySelectorAll('.pill').forEach(p=>p.onclick=()=>{
              const nj = p.dataset.nj;
              if(nj==='yes'){
                const d = over.r_store_ok_details.concat(["ç—‡çŠ¶æœªå†ç¾ã‚„ãŠå®¢æ§˜éƒ½åˆã®ä¿®ç†ä¸­æ­¢æ™‚ã¯è¦‹ç©ã‚Šä»£ãŒã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚"]);
                setResult(over.r_store_ok_title, d, 'ok');
              }else{
                setResult(over.r_warn_title, over.r_warn_details, 'warn');
              }
            });
          }else{
            // æµ·å¤–ï¼šä¿è¨¼å¤–
            setResult(over.r_warn_title, over.r_warn_details, 'warn');
          }
        }
      });
      return;
    }
  }

  // ---------- Apple flow ----------
  function renderAppleStart(){
    const a = DATA.text.apple;
    stage.innerHTML = `
      <div class="row">
        <div class="pill" data-a="yes">ãƒ¡ãƒ¼ã‚«ãƒ¼ä¿è¨¼ã®æœŸé–“å†…ã§ã™ã‹ï¼Ÿï¼ˆã¯ã„ï¼‰</div>
        <div class="pill" data-a="no">ãƒ¡ãƒ¼ã‚«ãƒ¼ä¿è¨¼ã®æœŸé–“å†…ã§ã™ã‹ï¼Ÿï¼ˆã„ã„ãˆï¼‰</div>
      </div>
    `;
    stage.querySelectorAll('.pill').forEach(b=>b.onclick=()=>{
      const v = b.dataset.a;
      if(v==='yes'){
        const body = a.r_direct_details.concat(["Appleã‚µãƒ¼ãƒ“ã‚¹&ã‚µãƒãƒ¼ãƒˆãƒ©ã‚¤ãƒ³ã€€0120-277-535 ã¸ã®ã”é€£çµ¡ã‚’ãŠå®¢æ§˜ã«ãŠä¼ãˆãã ã•ã„ã€‚"]);
        setResult(a.r_direct_title, body, 'ng');
      }else{
        // ãƒã‚¸ãƒä¿è¨¼åŒºåˆ†
        stage.innerHTML = `
          <div class="row">
            <div class="pill" data-g="ult">${a.l_ultimate}</div>
            <div class="pill" data-g="pp">${a.l_premium_plus}</div>
            <div class="pill" data-g="none">${a.l_no_contract}</div>
          </div>
        `;
        stage.querySelectorAll('.pill').forEach(p=>p.onclick=()=>{
          const g = p.dataset.g;
          if(g==='ult'){
            setResult(a.r_ultimate_title, a.r_ultimate_details, 'ok');
          }else if(g==='pp'){
            stage.innerHTML = `
              <div class="row">
                <div class="pill" data-d="after">${a.q_after_date}ï¼ˆã¯ã„ï¼‰</div>
                <div class="pill" data-d="before">${a.q_after_date}ï¼ˆã„ã„ãˆï¼‰</div>
              </div>`;
            stage.querySelectorAll('.pill').forEach(x=>x.onclick=()=>{
              const d = x.dataset.d;
              if(d==='after'){
                const det = [
                  "Appleç”¨ã®è£½å“ä¿®ç†ç”³è¾¼æ›¸ã‚’è¨˜è¼‰ã®ä¸Šã€ä¿®ç†å—ä»˜ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚",
                  "ãƒã‚¤ãƒ³ãƒˆãƒãƒƒã‚¯ã§ã®å¯¾å¿œã«ãªã‚Šã¾ã™ã€‚",
                  "è‡ªç„¶æ•…éšœãƒ»ç‰©æã®å ´åˆã§ãƒ•ãƒ­ãƒ¼ãŒå¤‰ã‚ã‚‹ã®ã§ã€è©³ã—ãã¯MDç­‰ã¸ã®ç¢ºèªã‚’è¡Œã£ã¦ãã ã•ã„ã€‚",
                  "â€» Appleè£½å“ä¿®ç†ç”³è¾¼æ›¸ã¯ãƒ‡ã‚¹ã‚¯ãƒãƒƒãƒ„ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡ºæ¥ã¾ã™"
                ];
                setResult(a.r_uchi_title, det, 'warn');
              }else{
                const det = [
                  "é€šå¸¸é€šã‚Šä¿®ç†å—ä»˜ã‚’ã—ã¦ãã ã•ã„ã€‚",
                  "ææºä¿®ç†å…ˆã‚¦ãƒãƒ€ã‚¨ã‚¹ã‚³ã§ã®ä¿®ç†å¯¾å¿œã«ãªã‚Šã¾ã™ã€‚",
                  "Appleç”¨è£½å“ä¿®ç†ç”³è¾¼æ›¸ã‚’è¨˜è¼‰ã®ä¸Šã€ä¿®ç†å—ä»˜ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚",
                  "â€» Appleè£½å“ä¿®ç†ç”³è¾¼æ›¸ã¯ãƒ‡ã‚¹ã‚¯ãƒãƒƒãƒ„ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡ºæ¥ã¾ã™"
                ];
                setResult(a.r_pre_title, det, 'ok');
              }
            });
          }else{
            const body = a.r_direct2_details.concat(["Appleã‚µãƒ¼ãƒ“ã‚¹&ã‚µãƒãƒ¼ãƒˆãƒ©ã‚¤ãƒ³ã€€0120-277-535 ã¸ã®ã”é€£çµ¡ã‚’ãŠå®¢æ§˜ã«ãŠä¼ãˆãã ã•ã„ã€‚"]);
            setResult(a.r_direct2_title, body, 'ng');
          }
        });
      }
    });
  }

  // ---------- VAIO extra flow ----------
  function renderVAIOGate(){
    const gate = `
      <div class="card">
        <div class="muted" style="margin-bottom:6px">æ™‚æœŸç›®å®‰ãƒ»è£½é€ å…ƒ</div>
        <div class="muted">ã€œ2014å¹´6æœˆé ƒã¾ã§ï¼šã‚½ãƒ‹ãƒ¼æ ªå¼ä¼šç¤¾</div>
        <div class="muted">2014å¹´7æœˆä»¥é™ï¼šVAIOæ ªå¼ä¼šç¤¾ï¼ˆé•·é‡çœŒå®‰æ›‡é‡å¸‚ï¼‰</div>
      </div>
      <div class="row">
        <div class="pill" data-v="sony">Sonyæ ªå¼ä¼šç¤¾ãŒè²©å£²ã—ã¦ã„ã‚‹VAIOã§ã™</div>
        <div class="pill" data-v="vaio">VAIOæ ªå¼ä¼šç¤¾ãŒè²©å£²ã—ã¦ã„ã‚‹VAIOã§ã™</div>
      </div>`;
    stage.innerHTML = gate;
    stage.querySelectorAll('.pill').forEach(p=>p.onclick=()=>{
      const v = p.dataset.v;
      if(v==='sony'){
        setResult("å—ä»˜çµ‚äº†ï¼ˆSonyè£½VAIOï¼‰", [
          "Sonyæ ªå¼ä¼šç¤¾ãŒè²©å£²ã—ã¦ã„ã‚‹VAIOè£½å“ã®ä¿®ç†å—ä»˜ã¯çµ‚äº†ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒé«˜ã„ã§ã™ãŒã€ä¸‹è¨˜ã«ã¦å•ã„åˆã‚ã›å¯èƒ½ã§ã™ã€‚",
          "VAIOã‚«ã‚¹ã‚¿ãƒãƒ¼ãƒªãƒ³ã‚¯ä¿®ç†ç›¸è«‡çª“å£ï¼š0120-60-5599ï¼ˆãƒ•ãƒªãƒ¼ãƒ€ã‚¤ãƒ¤ãƒ«ï¼‰",
          "å—ä»˜æ™‚é–“ï¼šæœˆï½é‡‘ 9:00ï½18:00ï¼ˆç¥æ—¥ãƒ»å¹´æœ«å¹´å§‹é™¤ãï¼‰"
        ], 'ng');
      }else{
        // å½“ç¤¾è³¼å…¥ï¼Ÿ
        stage.innerHTML = `
          <div class="row">
            <div class="pill" data-b="yes">å½“ç¤¾ã§è³¼å…¥ã—ã¦ã„ã¾ã™ï¼ˆã¯ã„ï¼‰</div>
            <div class="pill" data-b="no">å½“ç¤¾ã§è³¼å…¥ã—ã¦ã„ã¾ã›ã‚“ï¼ˆã„ã„ãˆï¼‰</div>
          </div>`;
        stage.querySelectorAll('.pill').forEach(x=>x.onclick=()=>{
          const b = x.dataset.b;
          if(b==='yes'){
            setResult("ä¿®ç†å—ä»˜å¯èƒ½ï¼ˆå½“ç¤¾è³¼å…¥ï¼šVAIOæ ªå¼ä¼šç¤¾è£½ï¼‰", [
              "ä¿®ç†å—ä»˜ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚",
              "ä¿®ç†ä¾é ¼å…ˆ:ãƒã‚¸ãƒä¿®ç†ã‚»ãƒ³ã‚¿ãƒ¼(ä¿®ç†ã‚»ãƒ³ã‚¿ãƒ¼çµŒç”±ã§VAIOã«ä¿®ç†ä¾é ¼)",
              "ä¿å®ˆæœŸé–“:ç™ºå£²æ—¥ã‹ã‚‰ç´„5å¹´(ç›®å®‰)"
            ], 'ok');
          }else{
            setResult("ä¿®ç†å—ä»˜å¯èƒ½ï¼ˆVAIOæ ªå¼ä¼šç¤¾è£½ï¼‰", [
              "ä¿®ç†å—ä»˜ã¯å¯èƒ½ã§ã™ãŒã€ãŠå®¢æ§˜ãŒãƒ¡ãƒ¼ã‚«ãƒ¼ã¨ç›´æ¥ã‚„ã‚Šå–ã‚Šã‚’ã™ã‚‹ã‚ˆã‚Šã‚‚é«˜é¡ã«ãªã‚‹å¯èƒ½æ€§ãŒé«˜ã„æ—¨ã‚’ã”èª¬æ˜ãã ã•ã„ã€‚"
            ], 'warn');
          }
        });
      }
    });
  }

  async function loadChangeLog(){
    try{
      const r = await fetch('update_log.json', {cache:'no-store'});
      const arr = await r.json();
      const el = document.getElementById('changelog');
      if(!Array.isArray(arr) || arr.length===0){ el.textContent = "å±¥æ­´ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚"; return; }
      el.innerHTML = arr.map(x=>`<div style="padding:8px 0;border-bottom:1px dashed #eee">
        <div><strong>${x.date}</strong>ï½œ${x.store}ï½œ${x.person}</div>
        <div>${x.note}</div>
      </div>`).join("");
    }catch(e){
      document.getElementById('changelog').textContent = "å±¥æ­´ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚";
    }
  }

  (async ()=>{
    await load();
    render({type:'home'});
    loadChangeLog();
  })();
  </script>
</body>
</html>
