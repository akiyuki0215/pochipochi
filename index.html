<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>店頭対応ナビ（MVP, シンプル版）</title>
  <style>
    :root{
      --brand:#0d6efd; --brand2:#0aa0ff; --fg:#222; --bg:#fff; --muted:#666; --bd:#e5e7eb;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:var(--fg);background:var(--bg)}
    /* Topbar */
    .topbar{
      position:sticky;top:0;z-index:1000;display:flex;align-items:center;gap:.5rem;
      padding:.6rem .9rem;background:linear-gradient(90deg,var(--brand),var(--brand2));color:#fff
    }
    .brand{font-weight:700;letter-spacing:.02em}
    .nav{margin-left:auto;display:flex;gap:.25rem;align-items:center}
    .nav a{
      color:#fff;text-decoration:none;padding:.45rem .65rem;border-radius:.4rem;opacity:.95
    }
    .nav a:hover{background:rgba(255,255,255,.15);opacity:1}
    .nav .cta{background:rgba(255,255,255,.18);font-weight:600}
    .nav .cta:hover{background:rgba(255,255,255,.28)}
    .hamburger{display:none;margin-left:auto;background:transparent;border:0;cursor:pointer}
    .hamburger span{display:block;width:22px;height:2px;background:#fff;margin:5px 0}
    /* Layout */
    .container{max-width:980px;margin:1.25rem auto;padding:0 1rem}
    .hero{background:#f8fafc;border:1px solid var(--bd);border-radius:.75rem;padding:1.25rem}
    .card{display:grid;gap:.5rem;padding:1rem;border:1px solid var(--bd);border-radius:.5rem;background:#fff;max-width:720px}
    .card input,.card select,.card textarea{width:100%;padding:.6rem;border:1px solid var(--bd);border-radius:.4rem;font:inherit}
    .btn{padding:.6rem 1rem;border:0;border-radius:.4rem;background:var(--brand);color:#fff;cursor:pointer}
    .btn:hover{filter:brightness(1.05)}
    /* Sections */
    section{scroll-margin-top:64px}
    /* Mobile */
    @media (max-width: 768px){
      .hamburger{display:block}
      .nav{display:none;position:absolute;right:.75rem;top:56px;flex-direction:column;background:var(--brand);border:1px solid rgba(255,255,255,.2);border-radius:.5rem;padding:.3rem;width:min(70vw,300px)}
      .nav.open{display:flex}
      .nav a{display:block;width:100%}
    }
  </style>
</head>
<body>
  <header class="topbar">
    <div class="brand" id="siteTitle">店頭対応ナビ（MVP）</div>
    <button class="hamburger" aria-label="メニュー" aria-expanded="false" aria-controls="mainnav">
      <span></span><span></span><span></span>
    </button>
    <nav id="mainnav" class="nav">
      <a href="#home">トップ</a>
      <a href="#flows">対応フロー</a>
      <a href="#docs">マニュアル</a>
      <a href="#faq">FAQ</a>
      <a href="#feedback" class="cta" id="feedbackLink">要望を出す</a>
    </nav>
  </header>

  <main class="container">
    <section id="home" class="hero">
      <h1>店頭対応ナビ（MVP, シンプル版）</h1>
      <p>1枚のHTMLと1つのJSONのみで構成。ナビは常時表示。スマホではハンバーガー開閉が可能です。</p>
    </section>

    <section id="flows">
      <h2>対応フロー</h2>
      <p>ここに社内用の簡易フローリンクやメモを追加してください。</p>
    </section>

    <section id="docs">
      <h2>マニュアル</h2>
      <p>リンクや手順を箇条書きで。必要に応じて外部ドキュメントへのURLもOKです。</p>
    </section>

    <section id="faq">
      <h2>FAQ</h2>
      <p>よくある質問と回答を列挙してください。</p>
    </section>

    <section id="feedback">
      <h2>要望を出す</h2>
      <p>機能改善や不具合報告などがあれば、下のフォームに記入してください。</p>
      <form class="card" id="feedbackForm">
        <label>お名前（任意）
          <input type="text" name="name" placeholder="例：長谷川">
        </label>
        <label>種別
          <select name="type">
            <option value="bug">不具合</option>
            <option value="improvement">改善要望</option>
            <option value="question">質問</option>
          </select>
        </label>
        <label>内容
          <textarea name="message" rows="6" placeholder="できるだけ具体的にご記入ください。"></textarea>
        </label>
        <button type="submit" class="btn">送信（ダミー）</button>
      </form>
      <p id="feedbackNote" style="color:var(--muted);font-size:.95rem;margin-top:.5rem;">
        送信先は <code>site.json</code> の <code>feedback.endpoint</code> で設定できます（未設定ならダミー送信）。
      </p>
    </section>
  </main>

  <script>
    // Mobile menu toggle
    const burger = document.querySelector('.hamburger');
    const nav = document.getElementById('mainnav');
    if (burger && nav){
      burger.addEventListener('click', () => {
        const expanded = burger.getAttribute('aria-expanded') === 'true';
        burger.setAttribute('aria-expanded', String(!expanded));
        nav.classList.toggle('open');
      });
    }

    // Load optional config from site.json (same-origin on GitHub Pages)
    async function loadConfig(){
      try{
        const res = await fetch('./site.json', {cache: 'no-store'});
        if(!res.ok) throw new Error('no config');
        const cfg = await res.json();
        if (cfg.title) document.getElementById('siteTitle').textContent = cfg.title;
        if (cfg.menu && cfg.menu.feedbackText){
          const fl = document.getElementById('feedbackLink');
          if (fl) fl.textContent = cfg.menu.feedbackText;
        }
        const note = document.getElementById('feedbackNote');
        if (cfg.feedback && cfg.feedback.endpoint){
          note.textContent = '送信は ' + cfg.feedback.endpoint + ' にPOSTされます。';
        }
      }catch(e){
        // silent: defaults are already applied
      }
    }
    loadConfig();

    // Dummy submit (replace with real endpoint via site.json)
    document.getElementById('feedbackForm').addEventListener('submit', async (ev) => {
      ev.preventDefault();
      let endpoint = null;
      try{
        const res = await fetch('./site.json', {cache:'no-store'});
        const cfg = await res.json();
        endpoint = cfg?.feedback?.endpoint || null;
      }catch(e){}
      if(!endpoint){
        alert('送信完了（ダミー）。site.json で実際の送信先を設定できます。');
        return;
      }
      const fd = new FormData(ev.target);
      const body = Object.fromEntries(fd.entries());
      try{
        const r = await fetch(endpoint, {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify(body)
        });
        if(!r.ok) throw new Error('failed');
        alert('送信しました。ありがとうございました。');
        ev.target.reset();
      }catch(e){
        alert('送信に失敗しました。エンドポイント設定またはCORSをご確認ください。');
      }
    });
  </script>
</body>
</html>
